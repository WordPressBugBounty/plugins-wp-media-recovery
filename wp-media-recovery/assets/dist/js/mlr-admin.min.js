(()=>{"use strict";var e,a={},a={pluginUrl:mlr.plugin_ur,pluginDomain:mlr.plugin_domain,ajaxUrl:mlr.ajax_url,ajaxNonce:mlr.ajax_nonce,generateRandomString:function(e){for(var t="",r=0;r<e;r++)t+="abcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(36*Math.random()));return t}},i={ajaxRequest:function(e,t,r,n){jQuery.ajax({method:"post",url:a.ajaxUrl,data:jQuery.extend({action:e,_wpnonce:a.ajaxNonce},r),beforeSend:function(){return i.beforeSendCallback(t)},success:function(e){return n(JSON.parse(e)[0])},complete:function(){return i.completeCallback(t)},error:function(){return i.errorCallback(t)}})},beforeSendCallback:function(e){e.find(".mlr-loading-bar").show()},completeCallback:function(e){e.find(".mlr-loading-bar").hide()},errorCallback:function(e){var e=e.find(".mlr-output").empty(),t='<storng>Internal Server Error!</strong><br />Contact your hosting provider and access your logs to learn more about what is causing the error; then the plugin author with the detials @ <a href="mailto:contact@'.concat(a.pluginDomain,'">contact@').concat(a.pluginDomain,"</a>.");e.addClass("mlr-output-active mlr-output-active-error"),e.html(t)},outputCallback:function(e,t,r){e=e.find(".mlr-output").empty();e.removeClass("mlr-output-active-success mlr-output-active-error").addClass("mlr-output-active-"+(1===t?"success":"error")),e.addClass("mlr-output-active").show().html(r)}},o={};o.ajaxUrl=mlr.ajax_url,o.pluginUrl=mlr.plugin_url,o.pluginDomain=mlr.plugin_domain,o.ajaxNonce=mlr.ajax_nonce,o.recoverMedia=function(e){e.preventDefault();var t=jQuery(e.target),r=t.closest(".mlr-explorer-pagination"),n=new Array,a=0;if(jQuery.each(jQuery(".mlr-media-thumbnail"),function(){var e=jQuery(this).find('input[name="image_files[]"]');e.is(":checked")&&e.val()&&(n[a++]=e.val())}),0===n.length)return window.alert("You MUST select at least 1 image for recovery."),!1;jQuery.ajax({type:"post",url:o.ajaxUrl,data:{_wpnonce:o.ajaxNonce,action:"mlr_recover_media",image_files:JSON.stringify(n)},beforeSend:function(){t.prop("disabled",!0).text("Recovery in progress..."),t.next().empty().addClass("mlr-in-progress")},success:function(e){void 0!==e.success&&!1===e.success||(1===(e=JSON.parse(e)[0]).status?(t.prop("disabled",!1).text("Media Recovery..."),t.next().removeClass("mlr-in-progress"),r.find("span").empty().html(e.message),jQuery(".mlr-explorer-grid").hide().load(window.location.href+" .mlr-explorer-grid > *","").fadeIn(),setTimeout(function(){jQuery('input[name="mlr-hide-existing-media"]').is(":checked")&&o.hideExistingMedia()},1e3)):window.alert(e.message))},complete:function(){},error:function(){window.alert("Internal Server Error! Contact your hosting provider and access your logs to learn more about what is causing the error.")}})},o.hideExistingMedia=function(e){var t=jQuery(".mlr-hide-media label"),r=jQuery('input[name="mlr-hide-existing-media"]'),n=0;void 0!==e&&(r.is(":checked")?localStorage.setItem("mlr-existing-media",1):localStorage.removeItem("mlr-existing-media")),localStorage.getItem("mlr-existing-media")&&r.prop("checked",!0),jQuery.each(jQuery(".mlr-media-thumbnail"),function(){jQuery(this).find(".dashicons").hasClass("dashicons-visibility")&&(jQuery(this).toggle(),n++)}),t.find("strong").remove(),0<n&&(e=jQuery("<strong/>").html(" &mdash; You have ".concat(n," hidden item(s) on this page.")),r.is(":checked"))&&t.append(e)},o.limitUsage=function(e){var e=jQuery(e.target),t=jQuery(".mlr-explorer-grid img.selected").length,r=jQuery(".mlr-explorer-pagination .button-action span");if(!jQuery(this).hasClass("in-library")&&!jQuery(this).hasClass("oversize-limit"))if(e.find('input[type="checkbox"]').is(":checked"))e.find("img").toggleClass("selected"),e.find('input[type="checkbox"]').prop("checked",!1),e.find(".dashicons").removeClass("dashicons-yes").addClass("dashicons-hidden");else{if(9<t)return window.alert("You CANNOT recover more than 10 images at a time."),!1;e.find("img").toggleClass("selected"),e.find('input[type="checkbox"]').prop("checked",!0),e.find(".dashicons").addClass("dashicons-yes").removeClass("dashicons-hidden")}t=jQuery(".mlr-explorer-grid img.selected").length,r.empty().text("You have selected ".concat(t,"/10 for recovery."))},o.handleSettingsNotices=function(){var e=jQuery(".notice.settings-error"),t=jQuery("#mlr-output");jQuery('input[name="_wp_http_referer"][value*="page=mlr_settings"]').length&&0<e.length&&t&&(t.html("\n      <strong>Options updated.</strong> Setting options have been saved and updated successfully.\n    "),t.addClass("notice-warning mlr-output-active"),setTimeout(function(){return e.fadeOut()},2e3))},o.resetSettings=function(e){e.preventDefault();var t=jQuery(e.target).closest(".mlr-admin");window.confirm("Are you sure you want to RESET ALL options to their defaults?")&&i.ajaxRequest("mlr_reset_settings",t,"",function(e){e&&!1===e.success||(i.outputCallback(t,e.status,e.message),jQuery("html, body").animate({scrollTop:0},"fast"),setTimeout(function(){return document.location.reload(!0)},2e3))})},e=jQuery,setTimeout(function(){return jQuery(".mlr-explorer-grid").css("display","flex")},1e3),localStorage.getItem("mlr-existing-media")&&o.hideExistingMedia(),e(document).on("click",'button[name="mlr-reset-settings"]',o.resetSettings),e(document).on("click",'button[name="mlr-media-recovery-button"]',o.recoverMedia),e(document).on("click",'input[name="mlr-hide-existing-media"]',o.hideExistingMedia),e(document).on("click",".mlr-media-thumbnail",o.limitUsage),o.handleSettingsNotices()})();